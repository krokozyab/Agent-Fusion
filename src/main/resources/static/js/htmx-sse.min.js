/*
HTMX SSE Extension - Handles Server-Sent Events with htmlFragment support
*/
!function(e){if(!e)return;var t={init:function(e){console.debug("HTMX SSE extension loaded")},onEvent:function(e,t){return!!(e&&e.startsWith("sse:")&&(t.detail.lastEvent===e.substring(4)||t.detail.eventType===e.substring(4)))}};e.defineExtension("sse",t);var n=e.ajax;e.ajax=function(e,t,r,o){if(r&&r.sse&&r.sse.swap){var s=r.sse.swap;r.onEvent=function(e,t){if(t.detail){var r=t.detail;if(r.lastEvent===s||r.eventType===s){return!0}}return!1}}return n(e,t,r,o)};var a=function(e){return new EventSource(e,{withCredentials:!0})};if(e.createEventSource){var i=e.createEventSource;e.createEventSource=function(e){console.debug("Creating EventSource");return a(e)}}else{e.createEventSource=a}document.addEventListener("htmx:sseMessage",function(e){if(e.detail&&e.detail.data){try{var t="string"==typeof e.detail.data?JSON.parse(e.detail.data):e.detail.data;if(t.htmlFragment){var n=document.createElement("div");n.innerHTML=t.htmlFragment;var a=n.firstElementChild;if(a){var i=a.getAttribute("sse-swap");if(i){var s=document.querySelector('[sse-swap="'+i+'"]');if(s){s.outerHTML=a.outerHTML;var o=new CustomEvent("htmx:sseSwap",{detail:{target:s,fragment:a,eventName:i},bubbles:!0});document.dispatchEvent(o)}}}}}}catch(e){console.debug("Error parsing SSE htmlFragment:",e)}},!1)}(window.htmx);
